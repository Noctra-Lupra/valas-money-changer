import{r as l,a as M,j as e,H as P,L as R}from"./app-CeA5vgJp.js";import{I as B}from"./InvoiceTemplate-K9YP5BAO.js";import{f as d,C as L,a as E,B as b}from"./calendar-BGu9f7VR.js";import{B as c,c as H}from"./button-Co2pPxdw.js";import{C as F,a as A,b as V,d as $,c as z}from"./card-DuXmaIcy.js";import{D as J,a as K,b as O,c as U,d as W}from"./dialog-C2wQKNmA.js";import{I as q}from"./input-Biyra0XF.js";import{S as G,a as Q,b as X,c as Y,d as x}from"./select-Cl1-FRH6.js";import{T as Z,a as ee,b as u,c as r,d as ae,e as s}from"./table-CChQfL5t.js";import{A as te}from"./AuthenticatedLayout-M3cp1-KL.js";import{P as se,a as re,b as le}from"./popover-Dv5uDSrI.js";import{S as ie}from"./search-Dgjm83mc.js";import{E as de}from"./eye-DGY3CYNs.js";import{P as w}from"./printer-BBc_7k99.js";import"./createLucideIcon-BMJE709E.js";import"./index-7eHb1Vwc.js";import"./index-D3ZO5ocX.js";function Te({transactions:i,filters:n,notaLayouts:S,invoiceTemplate:T}){const[m,C]=l.useState(n.search||""),[o,D]=l.useState(n.type||"all"),[h,j]=l.useState(n.start_date||""),[f,p]=l.useState(n.end_date||""),[t,I]=l.useState(void 0);l.useEffect(()=>{t?.from?j(d(t.from,"yyyy-MM-dd")):j(""),t?.to?p(d(t.to,"yyyy-MM-dd")):p("")},[t]);const _=a=>S?.find(k=>Number(k.template_id)===Number(a))?.layout??[],y=l.useRef(!0);l.useEffect(()=>{if(y.current){y.current=!1;return}const a=setTimeout(()=>{M.get(route("riwayat.index"),{search:m,type:o==="all"?void 0:o,start_date:h||void 0,end_date:f||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})},300);return()=>clearTimeout(a)},[m,o,h,f]);const g=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(a),v=a=>{window.open(route("riwayat.print",a),"_blank")};return e.jsxs(te,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Riwayat Transaksi & Nota"}),children:[e.jsx(P,{title:"Riwayat Transaksi"}),e.jsx("div",{className:"mx-auto w-full max-w-7xl",children:e.jsxs(F,{children:[e.jsx(A,{className:"space-y-0",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(V,{children:"Daftar Transaksi"}),e.jsx($,{children:"Lihat riwayat transaksi dan cetak ulang nota."})]}),e.jsxs("div",{className:"flex w-full flex-col gap-2 md:w-auto md:flex-row",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(se,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:H("w-full justify-start text-left font-normal md:w-[260px]",!t?.from&&"text-muted-foreground"),children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),t?.from?t.to?e.jsxs(e.Fragment,{children:[d(t.from,"dd/MM/yyyy")," ","-"," ",d(t.to,"dd/MM/yyyy")]}):d(t.from,"dd/MM/yyyy"):e.jsx("span",{children:"Pilih rentang tanggal"})]})}),e.jsx(le,{className:"w-auto p-0",align:"start",children:e.jsx(E,{initialFocus:!0,mode:"range",defaultMonth:t?.from,selected:t,onSelect:a=>I(a),numberOfMonths:2})})]})}),e.jsxs(G,{value:o,onValueChange:a=>D(a),children:[e.jsx(Q,{className:"w-full md:w-[140px]",children:e.jsx(X,{placeholder:"Tipe"})}),e.jsxs(Y,{children:[e.jsx(x,{value:"all",children:"Semua Tipe"}),e.jsx(x,{value:"buy",children:"Beli (Masuk)"}),e.jsx(x,{value:"sell",children:"Jual (Keluar)"})]})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(ie,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(q,{placeholder:"Cari Invoice/Nasabah...",className:"pl-9",value:m,onChange:a=>C(a.target.value)})]})]})]})}),e.jsxs(z,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Invoice"}),e.jsx(r,{children:"Waktu"}),e.jsx(r,{children:"Nasabah"}),e.jsx(r,{children:"Tipe"}),e.jsx(r,{children:"Valas"}),e.jsx(r,{className:"text-right",children:"Kurs"}),e.jsx(r,{className:"text-center",children:"Pembayaran"}),e.jsx(r,{className:"text-right",children:"Total (IDR)"}),e.jsx(r,{className:"text-right",children:"Aksi"})]})}),e.jsx(ae,{children:i.data.length===0?e.jsx(u,{children:e.jsx(s,{colSpan:7,className:"py-8 text-center text-muted-foreground",children:"Belum ada transaksi data."})}):i.data.map(a=>e.jsxs(u,{children:[e.jsx(s,{className:"font-mono font-medium",children:a.invoice_number}),e.jsx(s,{children:new Date(a.created_at).toLocaleString("id-ID")}),e.jsx(s,{children:a.customer_name}),e.jsx(s,{children:e.jsx(b,{variant:a.type==="buy"?"default":"secondary",className:a.type==="buy"?"bg-blue-600 text-white hover:bg-blue-700":"bg-orange-600 text-white hover:bg-orange-700",children:a.type==="buy"?"BELI":"JUAL"})}),e.jsxs(s,{children:[a.currency.code," ",e.jsxs("span",{className:"text-xs text-muted-foreground",children:["x ",a.amount]})]}),e.jsx(s,{className:"text-right",children:g(a.rate)}),e.jsx(s,{className:"text-center",children:e.jsx(b,{variant:"outline",className:"uppercase",children:a.financial_account?.type||"CASH"})}),e.jsx(s,{className:"text-right font-bold",children:g(a.total_idr)}),e.jsx(s,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(J,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(c,{size:"sm",variant:"outline",children:[e.jsx(de,{className:"mr-1 h-4 w-4"}),"Preview"]})}),e.jsxs(O,{className:"max-h-[90vh] max-w-4xl overflow-y-auto",children:[e.jsx(U,{children:e.jsx(W,{children:"Preview Nota"})}),e.jsx("div",{className:"overflow-x-auto py-4",children:e.jsx(B,{transaction:a,templateId:a.template_id??1,items:_(a.template_id??1),invoiceTemplate:T})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(c,{onClick:()=>v(a.id),children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Cetak Nota"]})})]})]}),e.jsx(c,{size:"sm",variant:"ghost",onClick:()=>v(a.id),children:e.jsx(w,{className:"h-4 w-4 text-muted-foreground hover:text-black"})})]})})]},a.id))})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",i.from," to ",i.to," ","of ",i.total," results"]}),e.jsx("div",{className:"flex gap-1",children:i.links.map((a,N)=>e.jsx(R,{href:a.url||"#",preserveScroll:!0,className:`rounded px-3 py-1 text-sm ${a.active?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"} ${!a.url&&"pointer-events-none opacity-50"}`,dangerouslySetInnerHTML:{__html:a.label}},N))})]})]})]})})]})}export{Te as default};

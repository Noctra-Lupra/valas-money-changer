import{r as n,j as e,d as J,u as Q,H as de,a as X}from"./app-6aKQxMge.js";import{c as Z,B as t}from"./button-DN3ap-Ga.js";import{C as d,a as m,b as h,d as u,c as x,e as w}from"./card-CsdVILFJ.js";import{C as me,a as he,b as ue,c as xe,d as pe,e as je,f as fe}from"./command-52546M3O.js";import{I as p}from"./input-e3nxWqAI.js";import{L as r}from"./label-DhLmc2m5.js";import{P as ge,a as be,b as ve}from"./popover-19JNz8D2.js";import{T as ye,a as Ne,b as D,c as S,d as ke,e as g}from"./table-C--ss7YW.js";import{A as Ce}from"./AuthenticatedLayout-3p6nE4rK.js";import{t as b}from"./index-DY33TqIM.js";import we from"./CreateUserForm-DpNNknAh.js";import{T as Y,D as Se}from"./DeleteUserForm-CeqBtJaF.js";import Te from"./ResetPasswordForm-maGB_bUR.js";import{W as _e,C as Ue}from"./wallet-IlXYIiyQ.js";import{c as R}from"./createLucideIcon-E6N6yDMf.js";import{e as Ae}from"./select-BR3yievR.js";import{T as Me}from"./trash-2-DtKywGsc.js";import"./dialog-B_rPANtZ.js";import"./search-DhfqdCpy.js";import"./index-B4bsyb25.js";import"./InputError-B0iwtPaj.js";import"./plus-Be2pzGr8.js";const Fe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Pe=R("file-text",Fe);const De=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Ie=R("key-round",De);const Re=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],He=R("users",Re),I=n.forwardRef(({className:H,...v},y)=>e.jsx("textarea",{className:Z("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",H),ref:y,...v}));I.displayName="Textarea";function na({auth:H,users:v=[],financialAccounts:y=[],currencies:L=[],openingBalances:o,yesterdayGrandTotal:ee=0,yesterdayTotalMoneyBalance:ae=0}){const[i,N]=n.useState("financial"),{invoiceTemplate:T}=J().props,{data:f,setData:_,put:se,processing:k}=Q({accounts:y.length>0?y.map(a=>{let s=Number(a.balance);if(o){const l=a.type.toLowerCase();l==="cash"&&o.cash!==void 0?s=Number(o.cash):l==="bca"&&o.bca!==void 0?s=Number(o.bca):l==="mandiri"&&o.mandiri!==void 0&&(s=Number(o.mandiri))}return{type:a.type,balance:s,account_name:a.account_name,account_number:a.account_number}}):[],grand_total:ee,total_money_balance:ae}),V=(a,s)=>{const l=[...f.accounts],F=s.replace(/[^0-9]/g,"");l[a].balance=Number(F),_("accounts",l)},le=a=>{const s=a.replace(/[^0-9]/g,"");_("grand_total",Number(s))},C=()=>{se(route("financial.update"),{preserveScroll:!0,onSuccess:()=>{b.success("Saldo berhasil diperbarui")},onError:()=>{b.error("Gagal memperbarui saldo")}})},[c,te]=n.useState(""),[G,K]=n.useState(""),[z,E]=n.useState(""),[O,$]=n.useState(!1),[B,U]=n.useState(!1),{data:A,setData:M,put:re}=Q({company_name:T?.company_name??"",address:T?.address??"",footer_note:T?.footer_note??""});console.log("GLOBAL invoiceTemplate:",J().props.invoiceTemplate);const ne=()=>{if(!c)return;U(!0);const a=s=>{const l=s.replace(/\./g,"").replace(",",".");return Number(l)||0};X.put(route("currencies.update-stock"),{code:c,stock_amount:a(G),average_rate:a(z)},{onSuccess:()=>{b.success("Stok berhasil dikoreksi."),U(!1)},onError:()=>{b.error("Gagal mengoreksi stok."),U(!1)},preserveScroll:!0})},[ie,W]=n.useState(null),[ce,q]=n.useState(null),j=a=>{if(!a&&a!==0)return"";const s=String(a),l=s.split(","),F=l[0].replace(/[^0-9]/g,""),P=new Intl.NumberFormat("id-ID").format(Number(F)||0);if(l.length>1){const oe=l[1].replace(/[^0-9]/g,"");return`${P},${oe}`}return s.endsWith(",")?`${P},`:P};return e.jsxs(Ce,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Pengaturan & Manajemen"}),children:[e.jsx(de,{title:"Settings"}),e.jsxs("div",{className:"flex w-full flex-col gap-6 px-4 py-6 md:flex-row",children:[e.jsxs("nav",{className:"flex w-full flex-col gap-2 md:w-64",children:[e.jsxs(t,{variant:i==="financial"?"default":"ghost",className:"w-full justify-start",onClick:()=>N("financial"),children:[e.jsx(_e,{className:"mr-2 h-4 w-4"})," Keuangan"]}),e.jsxs(t,{variant:i==="valas"?"default":"ghost",className:"w-full justify-start",onClick:()=>N("valas"),children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"})," Koreksi Stok Valas"]}),e.jsxs(t,{variant:i==="app"?"default":"ghost",className:"w-full justify-start",onClick:()=>N("app"),children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"})," Template Nota"]}),e.jsxs(t,{variant:i==="users"?"default":"ghost",className:"w-full justify-start",onClick:()=>N("users"),children:[e.jsx(He,{className:"mr-2 h-4 w-4"})," User Management"]})]}),e.jsxs("div",{className:"flex-1",children:[i==="financial"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Saldo Awal & Kas Fisik"}),e.jsx(u,{children:"Ubah saldo awal harian secara manual jika terjadi kesalahan input fatal."})]}),e.jsxs(x,{className:"space-y-4",children:[f.accounts.map((a,s)=>a.type!=="cash"?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:a.account_name}),e.jsx(p,{value:j(a.balance),onChange:l=>V(s,l.target.value)})]},a.type)),e.jsxs("div",{className:"flex gap-2 rounded border border-yellow-200 bg-yellow-50 p-3 text-xs text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400",children:[e.jsx(Y,{className:"h-4 w-4"}),"Perhatian: Mengubah saldo awal akan mempengaruhi laporan profit hari ini."]})]}),e.jsx(w,{children:e.jsx(t,{onClick:C,disabled:k,children:"Update Saldo Awal"})})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Saldo Rekening Bank"}),e.jsx(u,{children:"Penyesuaian saldo bank untuk pencatatan."})]}),e.jsx(x,{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.accounts.map((a,s)=>a.type==="cash"||a.type==="bca2"||a.type==="mandiri2"||a.type==="cash2"?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:a.account_name}),e.jsx(p,{value:j(a.balance),onChange:l=>V(s,l.target.value)})]},a.type))})}),e.jsx(w,{children:e.jsx(t,{onClick:C,disabled:k,children:"Update Saldo Bank"})})]}),e.jsxs(d,{className:"",children:[e.jsx(m,{className:"pb-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(h,{className:"text-lg",children:"Total Saldo Akhir Uang"}),e.jsx(u,{children:"Input manual untuk override Total Saldo Akhir tanpa mengubah rincian saldo."})]})})}),e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(r,{children:"Total Saldo Akhir (Manual Override)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{className:"text-lg font-bold",value:j(f.total_money_balance),onChange:a=>{const s=a.target.value.replace(/[^0-9]/g,"");_("total_money_balance",Number(s))}}),e.jsx(t,{onClick:C,disabled:k,children:"Update Total Saldo Akhir"})]})]})})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(h,{className:"text-lg",children:"Total Aset (Grand Total)"}),e.jsx(u,{children:"Input manual untuk override Grand Total."})]})})}),e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(r,{className:"",children:"Grand Total Awal (Manual Override)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{className:"text-lg font-bold",value:j(f.grand_total),onChange:a=>le(a.target.value)}),e.jsx(t,{onClick:C,disabled:k,children:"Update Grandtotal"})]})]})})]})]}),i==="valas"&&e.jsxs(d,{className:"border-red-200 dark:border-red-900",children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center gap-2 text-red-600 dark:text-red-400",children:[e.jsx(Y,{className:"h-5 w-5"}),"Koreksi Stok & Modal (Manual)"]}),e.jsxs(u,{children:["Fitur ini digunakan untuk"," ",e.jsx("b",{children:"Stock Opname"})," atau memperbaiki kesalahan input modal. Perubahan di sini akan tercatat di Audit Log."]})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(r,{children:"Pilih Mata Uang"}),e.jsxs(ge,{open:O,onOpenChange:$,children:[e.jsx(be,{asChild:!0,children:e.jsxs(t,{variant:"outline",role:"combobox","aria-expanded":O,className:"w-full justify-between py-5",children:[c?`${L.find(a=>a.code===c)?.code.toUpperCase()}`:"Pilih Valas...",e.jsx(me,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ve,{side:"bottom",align:"start",avoidCollisions:!1,className:"w-[300px] p-0",children:e.jsxs(he,{children:[e.jsx(ue,{placeholder:"Cari valas..."}),e.jsxs(xe,{children:[e.jsx(pe,{children:"Valas tidak ditemukan."}),e.jsx(je,{children:L.map(a=>e.jsxs(fe,{value:a.code,onSelect:s=>{te(a.code),K(String(Number(a.stock_amount)).replace(".",",")),E(String(Number(a.average_rate)).replace(".",",")),$(!1)},children:[e.jsx(Ae,{className:Z("mr-2 h-4 w-4",c===a.code?"opacity-100":"opacity-0")}),a.code.toUpperCase()]},a.id))})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Stok Fisik Baru (Lembar)"}),e.jsx(p,{value:j(G),onChange:a=>K(a.target.value.replace(/\./g,"")),disabled:!c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Rata-rata Modal Baru (IDR)"}),e.jsx(p,{value:j(z),onChange:a=>E(a.target.value.replace(/\./g,"")),disabled:!c})]})]})]}),e.jsx(w,{children:e.jsx(t,{variant:"destructive",disabled:!c||B,onClick:ne,children:B?"Menyimpan...":"Simpan Koreksi (Log Audit)"})})]}),i==="app"&&e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(h,{children:"Template Nota"}),e.jsx(u,{children:"Atur informasi yang muncul pada struk transaksi."})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Nama Perusahaan (Header)"}),e.jsx(p,{value:A.company_name,onChange:a=>M("company_name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Alamat & Telp"}),e.jsx(I,{rows:3,value:A.address,onChange:a=>M("address",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Catatan Kaki (Footer)"}),e.jsx(I,{rows:3,value:A.footer_note,onChange:a=>M("footer_note",a.target.value)})]})]}),e.jsx(w,{children:e.jsx(t,{onClick:()=>re(route("invoice-template.update"),{preserveScroll:!0,onSuccess:()=>{X.reload({only:["invoiceTemplate"]}),b.success("Template disimpan")}}),children:"Simpan Template"})})]}),i==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Manajemen User"}),e.jsx(u,{children:"Kelola akun staff dan admin."})]}),e.jsx(we,{})]}),e.jsx(x,{children:e.jsxs(ye,{children:[e.jsx(Ne,{children:e.jsxs(D,{children:[e.jsx(S,{children:"Nama"}),e.jsx(S,{children:"Username"}),e.jsx(S,{children:"Role"}),e.jsx(S,{className:"text-right",children:"Aksi"})]})}),e.jsx(ke,{children:v.length>0?v.map(a=>e.jsxs(D,{children:[e.jsx(g,{className:"font-medium",children:a.name}),e.jsx(g,{children:a.username}),e.jsx(g,{className:"badge capitalize",children:a.role}),e.jsx(g,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",size:"icon",title:"Reset Password",onClick:()=>W(a),children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(t,{variant:"destructive",size:"icon",title:"Hapus User",onClick:()=>q(a),children:e.jsx(Me,{className:"h-4 w-4"})})]})})]},a.id)):e.jsx(D,{children:e.jsx(g,{colSpan:4,className:"py-4 text-center text-gray-500",children:"Tidak ada data user."})})})]})})]}),e.jsx(Te,{user:ie,onClose:()=>W(null)}),e.jsx(Se,{user:ce,onClose:()=>q(null)})]})]})]})]})}export{na as default};
